# Process Peer Appraisal Script

Here's a quick guide on using this script/Jupyter Notebook.

1. Download the response sheet from Google Sheets as a `.csv` file. Note that the columns will need to be ordered correctly, i.e.

   | A1 - Member 1 | Q1 for A1M1 | Q2 for A1M1 | Q3 for A1M1 | Q4 for A1M1 | A1 - Member 2 | ... |
   | ------------- | ----------- | ----------- | ----------- | ----------- | ------------- | --- |

1. Download the student email sheet as a `.csv` file. Make sure that the student names in this sheet matches the names used in the peer appraisal form.

   | Name | Email |
   | ---- | ----- |

1. Copy both `.csv` files into the same directory as this script.
1. Install the dependencies required by running `pip install -r requirements.txt`.
1. Update the constants in the script as necessary, e.g. `TUTOR_NAME`, etc.
1. Keep `SHOULD_SEND_EMAIL` as `False` and run the entire notebook once. You should see a `peer-appraisals` folder being created, with the feedback stored as `.txt` files within. For example, `student-a.txt` would contain the feedback to be sent to Student A.
   - If errors occur, e.g. due to assertions failing, check that the files provided are correct + constants are defined correctly.
1. Once you're confident about the feedback generated, update `SHOULD_SEND_EMAIL` to `True`, and update all email-related constants.
   - You may need to enable less secure apps for your Gmail account: <https://support.google.com/accounts/answer/6010255?hl=en>
1. Re-run the entire notebook, which should now blast out the emails as well.

## Misc

The reason for choosing `.csv` over `.xlsx` is that `.xlsx` files generated by Google Sheets sometimes have strange reference errors (despite the original sheet not having any references), and they have new lines removed from the responses, which is not desirable.
